version: v1.0
name: Initial Pipeline
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804
blocks:
  - name: Build Project
    task:
      jobs:
        - name: Build and Unit Tests
          commands:
            - echo "job 1"
  - name: Static Code Analysis
    task:
      jobs:
        - name: DeteKt
          commands:
            - echo "job 1"
        - name: SonarQube
          commands:
            - echo "job 1"
        - name: 'Fortify '
          commands: []
  - name: Upload Artifacts
    task:
      jobs:
        - name: artifacts to s3/ECR etc
          commands: []
promotions:
  - name: Dev
    pipeline_file: pipeline_2.yml
    auto_promote:
      when: branch = 'master' AND result = 'passed'
